{% extends "admin/base_site.html" %}

{% block content %}
  <section class="card">
    <div class="card-title">Создать промокод</div>
    {% if error %}<div class="muted">Ошибка: {{ error }}</div>{% endif %}
    <form method="post" class="filters">
      {% csrf_token %}
      <div class="row">
        <label>Action</label>
        <select name="action">
          {% for a in actions %}<option value="{{ a }}">{{ a }}</option>{% endfor %}
        </select>
      </div>
      <div class="row">
        <label>Code (optional)</label>
        <input name="code" placeholder="AUTO" />
      </div>
      <div class="row">
        <label>Max uses</label>
        <input name="max_uses" type="number" value="1" min="1" />
      </div>
      <div class="row">
        <label>Valid from (ISO)</label>
        <input name="valid_from" value="{{ now|date:'c' }}" />
      </div>
      <div class="row">
        <label>Valid until (ISO)</label>
        <input name="valid_until" value="{{ now_plus_30|date:'c' }}" />
      </div>
      <button class="btn" type="submit">Создать</button>
    </form>
  </section>

  <section class="card">
    <div class="card-title">Промокоды</div>
    <table class="admin-table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Action</th>
          <th>Days</th>
          <th>Uses</th>
          <th>Valid</th>
        </tr>
      </thead>
      <tbody>
        {% for p in promocodes %}
          <tr>
            <td>{{ p.code }}</td>
            <td>{{ p.action }}</td>
            <td>{{ p.days_to_add }}</td>
            <td>{{ p.current_uses }}/{{ p.max_uses }}</td>
            <td>{{ p.valid_from }} → {{ p.valid_until }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="5" class="muted">Нет данных</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
{% endblock %}

