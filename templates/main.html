{% extends "base.html" %}
{% block body %}
  <header class="app-header">
    <div class="app-title">CargoTech Driver WebApp</div>
    <div class="app-meta">
      <span id="driver-name" class="muted">…</span>
      <a class="link" href="{% url 'paywall' %}">Подписка</a>
    </div>
  </header>

  <main class="app-main">
    <section class="card">
      <div class="card-title">Фильтры</div>
      <form id="filters-form" class="filters">
        <div class="row">
          <label>Погрузка (город)</label>
          <div class="input-with-clear">
            <input id="start_city_query" type="text" placeholder="Начните ввод…" autocomplete="off" />
            <button type="button" class="input-clear" data-clear-target="start_city_query" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
          <input id="start_point_id" name="start_point_id" type="hidden" />
          <input id="start_point_type" name="start_point_type" type="hidden" />
          <div id="start_city_suggest" class="suggest"></div>
        </div>
        <div class="row">
          <label>Выгрузка (город)</label>
          <div class="input-with-clear">
            <input id="finish_city_query" type="text" placeholder="Начните ввод…" autocomplete="off" />
            <button type="button" class="input-clear" data-clear-target="finish_city_query" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
          <input id="finish_point_id" name="finish_point_id" type="hidden" />
          <input id="finish_point_type" name="finish_point_type" type="hidden" />
          <div id="finish_city_suggest" class="suggest"></div>
        </div>
        <div class="row">
          <label>Дата</label>
          <div class="input-with-clear">
            <input id="start_date" name="start_date" type="date" />
            <button type="button" class="input-clear" data-clear-target="start_date" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
        </div>
        <div class="row">
          <label>Вес/Объём</label>
          <div class="input-with-clear">
            <input id="weight_volume" name="weight_volume" type="text" placeholder="например 15-65 или 1.5-9" />
            <button type="button" class="input-clear" data-clear-target="weight_volume" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
        </div>
        <div class="row">
          <label>Тип погрузки (id через запятую)</label>
          <div class="input-with-clear">
            <input id="load_types" name="load_types" type="text" placeholder="например 1,2,3" />
            <button type="button" class="input-clear" data-clear-target="load_types" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
        </div>
        <div class="row">
          <label>Тип кузова (id через запятую)</label>
          <div class="input-with-clear">
            <input id="truck_types" name="truck_types" type="text" placeholder="например 1,2,4" />
            <button type="button" class="input-clear" data-clear-target="truck_types" aria-label="Сбросить" title="Сбросить">×</button>
          </div>
        </div>
        <div class="actions">
          <button type="button" id="apply-filters" class="btn">Применить</button>
          <button type="button" id="reset-filters" class="btn btn-secondary">Сброс</button>
        </div>
      </form>
    </section>

    <section class="card">
      <div class="card-title">Грузы</div>
      <div id="cargo-list">
        <div class="muted">Авторизация…</div>
      </div>
    </section>
  </main>

  <div id="modal-root" class="modal-root hidden" aria-hidden="true">
    <div class="modal-backdrop" data-modal-close="1"></div>
    <div class="modal" role="dialog" aria-modal="true">
      <div id="modal-header" class="modal-header">
        <div class="modal-title"></div>
        <button class="btn btn-icon" type="button" data-modal-close="1">✕</button>
      </div>
      <div id="modal-body" class="modal-body">
        {% include "cargos/components/loading_spinner.html" %}
      </div>
    </div>
  </div>

  <section id="dev-auth" class="dev-auth hidden">
    <div class="card">
      <div class="card-title">Dev auth</div>
      <p class="muted">Если вы не в Telegram, вставьте initData вручную.</p>
      <textarea id="dev-initdata" rows="4" placeholder="initData из Telegram WebApp"></textarea>
      <div class="actions">
        <button type="button" id="dev-login" class="btn">Войти</button>
      </div>
    </div>
  </section>
{% endblock %}
