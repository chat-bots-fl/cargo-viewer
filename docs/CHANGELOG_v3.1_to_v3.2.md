# CHANGELOG: v3.1 ‚Üí v3.2

**–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞:** 2026-01-07  
**–¢–∏–ø —Ä–µ–ª–∏–∑–∞:** Minor (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è + –Ω–æ–≤—ã–µ —Ñ–∏—á–∏)  
**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ß–∞—Å—Ç–∏—á–Ω–∞—è (—Å–º. Breaking Changes)

## Summary

–í–µ—Ä—Å–∏—è 3.2 –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ HAR —Ñ–∞–π–ª–æ–≤ —Å production API
CargoTech. –í–Ω–µ—Å–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –º–µ–∂–¥—É
–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π v3.1 –∏ —Ä–µ–∞–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º API.

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 184 API-–∑–∞–ø—Ä–æ—Å–∞
- –ù–∞–π–¥–µ–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π: 3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö, 2 –≤–∞–∂–Ω—ã—Ö
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 6
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤: 1
- –û–±–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤: 2

---

## üî¥ Breaking Changes

### 1. Contract 3.1: filter[wv] –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥

**–ë—ã–ª–æ (v3.1):**
```python
WEIGHT_VOLUME_MAP = {
    "1_3": "1-15",
    "3_5": "3-25",
    # ...
}
```

**–°—Ç–∞–ª–æ (v3.2):**
```python
# API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ "{–≤–µ—Å}-{–æ–±—ä–µ–º}"
# –í–∞–ª–∏–¥–∞—Ü–∏—è: /^\d+(\.\d+)?-\d+(\.\d+)?$/
# –ü—Ä–∏–º–µ—Ä—ã: "1-15", "1.5-9", "7.5-45", "20-83"
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∂–µ—Å—Ç–∫–∏–π –º–∞–ø–ø–∏–Ω–≥ - –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞
- Frontend: –º–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –Ω–æ –¥–æ–±–∞–≤—å—Ç–µ –æ–ø—Ü–∏—é "–ö–∞—Å—Ç–æ–º–Ω—ã–π –≤–≤–æ–¥"
- Backend: –æ–±–Ω–æ–≤–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é (—Å–º. `IMPLEMENTATION_CODE_v3.2.md`)

### 2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã API

**–î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É):
- `filter[mode]` - –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "my" –∏–ª–∏ "all"
- `filter[user_id]` - –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 0 (—Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- `filter[start_point_type]` - –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ start_point_id

---

## ‚ú® New Features

### 1. Contract 2.4: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≥–æ—Ä–æ–¥–æ–≤

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞ –≥–æ—Ä–æ–¥–æ–≤:

```python
DictionaryService.search_cities(query: str)
```

Endpoint: `GET /v1/dictionaries/points?filter[name]={query}`

**Use case:**
```javascript
// Frontend –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç
const cities = await searchCities('–ú–æ—Å–∫');
// [{ id: 1, name: '–ú–æ—Å–∫–≤–∞', ... }]
```

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

- `filter[distance]` - –¥–∏–∞–ø–∞–∑–æ–Ω —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –≤ –∫–º (`"{min},{max}"`, –ø—Ä–∏–º–µ—Ä: `0,9999`)
- `filter[price]` - –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω—ã –≤ –∫–æ–ø–µ–π–∫–∞—Ö (`"{min},{max}"`, –ø—Ä–∏–º–µ—Ä: `0,99999900`)
- `filter[price_per_km]` - –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω—ã –∑–∞ –∫–º –≤ –∫–æ–ø–µ–π–∫–∞—Ö (`"{min},{max}"`, –ø—Ä–∏–º–µ—Ä: `0,99900`)
- `filter[owner_company]` - –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏-–≤–ª–∞–¥–µ–ª—å—Ü–∞ (–ø—Ä–∏–º–µ—Ä: `7700000000`)

---

## üîß Bug Fixes

### 1. Authorization header –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Ç–≤–µ—Ä–∂–¥–∞–ª–∞, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑
`Authorization: Bearer`, –Ω–æ –≤ HAR —Ñ–∞–π–ª–∞—Ö –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ
–º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–∫–µ–Ω–∞ (HAR capture may hide Authorization header).

### 2. –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ 100% –∑–∞–ø—Ä–æ—Å–æ–≤:
- `filter[user_id]`: 0
- `filter[start_point_type]`: 2
- `filter[finish_point_type]`: 2

### 3. Authorization mechanism verified (v3.2.1)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ —É—Ç–æ—á–Ω—è–ª–∞ –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–∫–µ–Ω–∞
(Bearer header vs Cookie).

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–µ–Ω–æ browser testing (2026-01-08):
- ‚úÖ Bearer Token: –†–ê–ë–û–¢–ê–ï–¢ (HTTP 200)
- ‚ùå Cookie Auth: CORS –±–ª–æ–∫–∏—Ä—É–µ—Ç (–ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ localStorage.accessToken
- –û–ø–∏—Å–∞–Ω —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞ (ID|hash, 54 —Å–∏–º–≤–æ–ª–∞)
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ (JS/Python)
- –£–¥–∞–ª–µ–Ω—ã —É–ø–æ–º–∏–Ω–∞–Ω–∏—è cookie-based auth

---

## üìù Documentation Updates

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `API_CONTRACTS_v3.2.md` - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω Contract 3.1, –¥–æ–±–∞–≤–ª–µ–Ω 2.4
- `IMPLEMENTATION_CODE_v3.2.md` - –Ω–æ–≤—ã–π –∫–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ filter[wv]
- `FINAL_PROJECT_DOCUMENTATION_v3.2.md` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `CHANGELOG_v3.1_to_v3.2.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª
- `compliance_analysis_report.txt` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ HAR

---

## üß™ Testing Recommendations

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

1. **Test filter[wv] validation**
   ```python
   # –î–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏
   assert validate_weight_volume("1-15") == {"filter[wv]": "1-15"}
   assert validate_weight_volume("1.5-9") == {"filter[wv]": "1.5-9"}
   assert validate_weight_volume("20-83") == {"filter[wv]": "20-83"}

   # –î–æ–ª–∂–Ω—ã —É–ø–∞—Å—Ç—å
   with pytest.raises(ValidationError):
       validate_weight_volume("abc-def")
   with pytest.raises(ValidationError):
       validate_weight_volume("1000-500")  # out of range
   ```

2. **Test mandatory parameters**
   ```python
   params = build_cargo_list_params({})
   assert params["filter[mode]"] == "my"
   assert params["filter[user_id]"] == 0
   assert params["include"] == "contacts"
   ```

3. **Test city autocomplete**
   ```python
   cities = search_cities("–ú–æ—Å–∫")
   assert len(cities) > 0
   assert cities[0]["name"] == "–ú–æ—Å–∫–≤–∞"
   ```

---

## üìä Migration Checklist

- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (v3.1 ‚Üí v3.2)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ filter[wv]
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ API –∫–ª–∏–µ–Ω—Ç
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Contract 2.4 (city autocomplete)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç weight_volume
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –≤–∞–ª–∏–¥–∞—Ü–∏–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Bearer Token) ‚Äî verified 2026-01-08
- [ ] –û–±–Ω–æ–≤–∏—Ç—å README —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π
- [ ] –°–æ–∑–¥–∞—Ç—å Git tag v3.2

---

## üë• Contributors

- –ê–Ω–∞–ª–∏–∑ HAR: AI Assistant
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: Project Team
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: QA Team

---

## üìû Support

–í–æ–ø—Ä–æ—Å—ã –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏: [–≤–∞—à email/slack]  
–ë–∞–≥–∏: [issue tracker]
